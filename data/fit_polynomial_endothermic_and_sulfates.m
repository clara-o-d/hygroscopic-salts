function polynomial_fitter_tabs()
    % 1. GET DATA
    solutes = load_all_data(); 
    
    % 2. PREPARE FIGURE
    f = figure('Name', 'Solute Fits', 'NumberTitle', 'off', 'Color', 'w');
    tabgp = uitabgroup(f); 
    
    colors = lines(length(solutes)); % Generate distinct colors for the summary
    
    fprintf('--- POLYNOMIAL FITTING RESULTS (4th Order) ---\n');

    % ---------------------------------------------------------
    % 3. GENERATE INDIVIDUAL TABS & CALCULATE FITS
    % ---------------------------------------------------------
    for i = 1:length(solutes)
        % Extract Data
        name = solutes(i).name;
        XY = solutes(i).data;
        degree = solutes(i).degree;
        x = XY(:, 1);
        y = XY(:, 2);
        
        % Perform Fit (4th Order, unless )
        if check_constraints(i)
            % --- CONSTRAINED FIT (Intercept forced to 1) ---  # NOT USED
            % 1. Create Design Matrix (x^4 down to x^1, NO column of ones)
            M = [x.^4, x.^3, x.^2, x];
            % 2. Solve for coefficients using matrix division (\)
            coeffs = M \ (y - 1);
            % 3. Construct the full polynomial vector p
            p = [coeffs', 1];
            % 4. Manually calculate S.normr for your R^2 calc later
            S.normr = norm(y - polyval(p, x));
        else
            [p, S] = polyfit(x, y, degree);
        end
        
        % Generate Smooth Fit Line (Strictly within data range - NO EXTRAPOLATION)
        x_fit = linspace(min(x), max(x), 200);
        y_fit = polyval(p, x_fit);
        
        % Store fit data for the summary tab later
        solutes(i).p = p;
        solutes(i).x_fit = x_fit;
        solutes(i).y_fit = y_fit;
        solutes(i).rsq = 1 - S.normr^2 / ((length(y)-1) * var(y));
        
        % --- PRINT STATS ---
        fprintf('\n>>> %s <<<\n', name);
        fprintf('  Input Range:  [%.4f, %.4f]\n', min(x), max(x));
        fprintf('  Output Range: [%.4f, %.4f]\n', min(y), max(y));
        fprintf('  Coeffs:       %s\n', mat2str(p, 4));
        fprintf('  R-squared:    %.5f\n', solutes(i).rsq);
        
        % --- CREATE INDIVIDUAL TAB ---
        t = uitab(tabgp, 'Title', name);
        ax = axes('Parent', t);
        hold(ax, 'on'); grid(ax, 'on');
        
        % Plot Data & Fit
        plot(ax, x, y, 'ko', 'MarkerFaceColor', 'k', 'DisplayName', 'Data');
        plot(ax, x_fit, y_fit, 'r-', 'LineWidth', 1.5, 'DisplayName', '4th Order Fit');
        
        legend(ax, 'Location', 'best');
        title(ax, [name ' Fit (R^2 = ' num2str(solutes(i).rsq, '%.4f') ')']);
        xlabel(ax, 'Mass Fraction (Salt)'); ylabel(ax, 'RH');
    end
    
    % ---------------------------------------------------------
    % 4. CREATE SUMMARY TAB (LAST)
    % ---------------------------------------------------------
    t_summary = uitab(tabgp, 'Title', 'All Solutes Summary');
    ax_summary = axes('Parent', t_summary);
    hold(ax_summary, 'on'); grid(ax_summary, 'on');
    
    for i = 1:length(solutes)
        c = colors(i, :);
        x = solutes(i).data(:, 1);
        y = solutes(i).data(:, 2);
        
        % Plot Data Points (Circles)
        plot(ax_summary, x, y, 'o', 'Color', c, 'MarkerFaceColor', c, ...
            'HandleVisibility', 'off'); % Hide points from legend to keep it clean
        
        % Plot Fitted Lines (Solid lines)
        plot(ax_summary, solutes(i).x_fit, solutes(i).y_fit, '-', ...
            'Color', c, 'LineWidth', 2, 'DisplayName', solutes(i).name);
    end
    
    title(ax_summary, 'Comparison of Fitted Polynomials');
    xlabel(ax_summary, 'Mass Fraction (Salt)'); ylabel(ax_summary, 'RH');
    legend(ax_summary, 'Location', 'bestoutside'); % Move legend outside if crowded
end
% ==========================================
%           DATA SECTION
% ==========================================
function solute_fixed_intercept = check_constraints(i)
    % Just copy-paste this block for each new solute and increment the index (i)
    solutes_with_fixed_intercept =  false(1,37);  %[false,false,false,false,false,false,false,false];
    solute_fixed_intercept = solutes_with_fixed_intercept(i);
end
function solutes = load_all_data()
    standard_degree = 4;

    i = 1;
    solutes(i).name = 'NaCl';
    solutes(i).degree = standard_degree;
    solutes(i).data = [
0.011553555	0.9934
0.017230794	0.99
0.028391848	0.9835
0.055216011	0.967
0.080598843	0.95
0.104653474	0.932
0.127481497	0.913
0.149174401	0.894
0.169814798	0.872
0.189477472	0.852
0.208230288	0.83
0.22613497	0.808
0.243247784	0.784
0.259620126	0.762
    ];

    i = i + 1;
    solutes(i).name = 'CsCl';
    solutes(i).degree = standard_degree;
    solutes(i).data = [
0.003590065	0.993
0.048080411	0.99
0.07764521	0.984
0.144101619	0.97
0.201625172	0.955
0.251903531	0.94
0.29622442	0.924
0.335587464	0.91
0.370780493	0.894
0.402432816	0.879
0.431053175	0.863
0.457057305	0.847
0.480788257	0.833
0.502531617	0.817
    ];

    i = i + 1;
    solutes(i).name = 'NH4Cl';
    solutes(i).degree = standard_degree;
    solutes(i).data = [
0.01058496	0.993
0.015793851	0.99
0.026048812	0.984
0.050774995	0.968
0.07427679	0.952
0.096642945	0.937
0.117953829	0.92
0.138282407	0.905
0.157695066	0.889
0.176252344	0.873
0.194009557	0.855
0.211017354	0.842
0.227322196	0.824
0.242966783	0.812
    ];

    i = i + 1;
    solutes(i).name = 'KCl';
    solutes(i).degree = standard_degree;
    solutes(i).data = [
0.014691152	0.9935
0.021876036	0.9903
0.035935969	0.9839
0.069378745	0.9682
0.100579092	0.9525
0.129755235	0.9363
0.157097973	0.9201
0.182774855	0.904
0.206933621	0.887
0.229705039	0.869
0.251205279	0.852
    ];

    i = i + 1;
    solutes(i).name = 'NaNO3';
    solutes(i).degree = standard_degree;
    solutes(i).data = [
0.000866188	0.9996
0.004240144	0.9983
0.008452839	0.9967
0.016722888	0.9935
0.024848043	0.9905
0.032895666	0.9875
0.040780267	0.9845
0.04851426	0.9816
0.056169967	0.9787
0.063681107	0.9758
0.071066307	0.973
0.078480293	0.9701
    ];

    i = i + 1;
    solutes(i).name = 'AgNO3';
    solutes(i).degree = standard_degree;
    solutes(i).data = [
0.078141459	0.986
0.14508003	0.974
0.202955524	0.965
0.253302488	0.955
0.253586517	0.956
0.297834362	0.946
0.298169211	0.947
0.337129715	0.941
0.337502707	0.94
0.372594496	0.933
0.404276337	0.928
0.43307617	0.922
0.458573223	0.916
0.458822089	0.917
0.482876861	0.911
0.505133946	0.907
0.52474984	0.902
0.542656842	0.896
0.560086789	0.892
0.574491037	0.888
0.575992777	0.886
0.604214591	0.879
0.628679915	0.87
0.651662409	0.862
0.670865342	0.855
    ];

    i = i + 1;
    solutes(i).name = 'KI';
    solutes(i).degree = standard_degree;
    solutes(i).data = [
0.00016597	1
0.000331886	0.9999
0.000829302	0.9998
0.001657229	0.9997
0.003308974	0.9993
0.008231579	0.9983
0.016328746	0.9966
0.032132804	0.9934
0.047437063	0.9901
0.062264863	0.9868
0.076638113	0.9836
0.0905774	0.9803
0.104102084	0.977
0.117230392	0.9737
0.129979497	0.9704
0.142365596	0.9671
    ];



    i = i + 1;
    solutes(i).name = 'Na2SO4';
    solutes(i).degree = standard_degree;
    solutes(i).data = [
0.014005558	0.9957
0.027624223	0.992
0.040871809	0.9882
0.053763278	0.9848
0.066312799	0.9815
0.0785338	0.9781
0.090439013	0.9749
0.102040523	0.9718
0.124377761	0.966
0.175643565	0.95
0.221238387	0.935
0.262053889	0.918
0.29880411	0.899
    ];


    i = i + 1;
    solutes(i).name = 'K2SO4';
    solutes(i).degree = standard_degree;
    solutes(i).data = [
0.017127439	0.9958
0.033678059	0.992
0.049680517	0.9884
0.065161602	0.985
0.080146386	0.9815
0.094658358	0.9783
0.108719548	0.975
0.12235064	0.972
    ];

    i = i + 1;
    solutes(i).name = '(NH4)2SO4';
    solutes(i).degree = standard_degree;
    solutes(i).data = [
0.013041619	0.9959
0.025747449	0.9921
0.038130295	0.9886
0.050202316	0.9853
0.061975072	0.982
0.073459555	0.9788
0.084666223	0.9756
0.095605038	0.9724
0.116716624	0.9662
0.165421232	0.95
0.209035347	0.935
0.248317405	0.919
0.283882303	0.902
0.316233823	0.885
0.345788645	0.867
0.372894395	0.85
0.397843376	0.831
    ];

    i = i + 1;
    solutes(i).name = 'MgSO4';
    solutes(i).degree = standard_degree;
    solutes(i).data = [
0.023507609	0.996
0.034851773	0.9941
0.045935387	0.9924
0.056767327	0.9906
0.067356067	0.9888
0.077709708	0.987
0.087835994	0.9851
0.097742331	0.9832
0.107435809	0.9812
0.126211054	0.9768
0.14421269	0.9717
0.161487567	0.966
0.178078823	0.9598
0.194026252	0.9529
0.231312634	0.932
0.265301636	0.905
    ];


    i = i + 1;
    solutes(i).name = 'MnSO4';
    solutes(i).degree = standard_degree;
    solutes(i).data = [
0.029314809	0.9961
0.043337006	0.9945
0.056959851	0.9929
0.070200166	0.9913
0.08307384	0.9898
0.095595894	0.9882
0.107780539	0.9866
0.119641232	0.985
0.131190722	0.9832
0.153403835	0.9794
0.174509405	0.975
0.194588252	0.9703
0.213713516	0.9649
0.231951553	0.959
0.274047977	0.941
0.311769607	0.919
    ];


    i = i + 1;
    solutes(i).name = 'Li2SO4';
    solutes(i).degree = standard_degree;
    solutes(i).data = [
0.010874896	0.9956
0.021515811	0.9915
0.031930214	0.9875
0.042125262	0.9833
0.052107814	0.9793
0.061884444	0.9753
0.071461459	0.971
0.080844911	0.9667
0.099054133	0.9585
0.141569669	0.935
0.18025342	0.911
0.215601067	0.883
0.248026332	0.853
    ];

    i = i + 1;
    solutes(i).name = 'NiSO4';
    solutes(i).degree = standard_degree;
    solutes(i).data = [
0.030021984	0.9962
0.044366983	0.9946
0.05829387	0.9931
0.071820661	0.9916
0.084964354	0.9901
0.097740996	0.9887
0.110165751	0.9871
0.122252959	0.9855
0.13401619	0.9838
0.156621466	0.98
0.178076607	0.9758
0.198467213	0.971
0.217870593	0.965
0.23635675	0.9588
0.278962283	0.939
    ];


    i = i + 1;
    solutes(i).name = 'CuSO4';
    solutes(i).degree = standard_degree;
    solutes(i).data = [
0.030934246	0.9963
0.045694604	0.9947
0.060012063	0.9932
0.073906262	0.9917
0.087395697	0.9901
0.100497801	0.9885
0.11322902	0.9868
0.125604882	0.9851
0.137640062	0.9833
0.160743136	0.9795
0.182640621	0.975
    ];

    i = i + 1;
    solutes(i).name = 'ZnSO4';
    solutes(i).degree = standard_degree;
    solutes(i).data = [
0.031278581	0.9962
0.046195408	0.9946
0.060659809	0.993
0.07469206	0.9914
0.088311242	0.9898
0.101535331	0.9882
0.114381272	0.9865
0.126865058	0.9847
0.13900179	0.9828
0.162290416	0.9788
0.184352381	0.9743
0.205282115	0.9692
0.225164596	0.9634
0.244076508	0.957
0.287549609	0.938
    ];

    i = i + 1;
    solutes(i).name = 'LiNO3';
    solutes(i).degree = standard_degree;
    solutes(i).data = [
0.006848771	0.9967
0.013604369	0.9934
0.020268682	0.99
0.026843548	0.9866
0.033330756	0.9831
0.064511301	0.9643
0.093743203	0.945
0.1212036	0.9239
0.147048789	0.9033
0.171417208	0.8818
0.194431913	0.8567
0.216202659	0.8329
0.236827645	0.8087
0.27498405	0.7591
0.292666365	0.7353
    ];


    i = i + 1;
    solutes(i).name = 'KNO3';
    solutes(i).degree = standard_degree;
    solutes(i).data = [
0.010008811	0.9967
0.019819255	0.9938
0.029437171	0.9909
0.038868171	0.9881
0.048117653	0.9854
0.091817274	0.9726
0.131680632	0.9623
0.168191649	0.9528
0.201756136	0.944
0.232716949	0.9376
0.261365735	0.9315
    ];

    i = i + 1;
    solutes(i).name = 'NH4NO3';
    solutes(i).degree = standard_degree;
    solutes(i).data = [
0.126790348	0.95
0.174629874	0.93
0.222790032	0.91
0.270211969	0.89
0.314154681	0.87
0.357074986	0.85
0.395186255	0.83
0.427506479	0.81
0.46075604	0.79
0.48862497	0.77
0.523144041	0.75
0.545629301	0.732
0.566499639	0.715
0.581323398	0.706
0.596943798	0.697
0.60507308	0.686
0.613426831	0.676
0.622014477	0.665
0.630845983	0.654
0.639931884	0.645
0.649283333	0.629
0.658912144	0.62
    ];

    i = i + 1;
    solutes(i).name = 'Ba(NO3)2';
    solutes(i).degree = standard_degree;
    solutes(i).data = [
0.025468409	0.9958
0.049671757	0.9923
0.072702017	0.989
0.094642456	0.9859
    ];

    i = i + 1;
    solutes(i).name = 'Ca(NO3)2';
    solutes(i).degree = standard_degree;
    solutes(i).data = [
0.01614506	0.9955
0.031777076	0.9911
0.046920122	0.9867
0.061596787	0.9825
0.075828289	0.9781
0.140967271	0.9566
0.197528387	0.9296
0.24710134	0.9043
0.290905868	0.8741
0.329893453	0.8458
0.364817226	0.8119
0.396281092	0.7791
0.424774943	0.7462
0.450700357	0.7123
0.474389635	0.6785
0.496120125	0.6464
    ];


    i = i + 1;
    solutes(i).name = 'NaClO4';
    solutes(i).degree = standard_degree;
    solutes(i).data = [
0.02083468	0.993399648
0.02083468	0.990167198
0.030929813	0.986949534
0.04081891	0.983736654
0.050508215	0.980528581
0.069311188	0.977310547
0.078436143	0.97408342
0.087383904	0.970853658
0.096159582	0.96762275
0.113214173	0.961145366
0.129637076	0.954644613
0.145462749	0.94810584
0.160723188	0.941530436
0.175448144	0.934925178
0.203400524	0.921574397
0.223151937	0.911477687
0.241947588	0.901261665
0.265637874	0.887506052
0.282456124	0.877109847
0.298521283	0.866721748
0.323755456	0.849088256
0.347237181	0.831394046
0.369142886	0.813567169
0.389626085	0.795726799
0.408820982	0.777525106
    ];

    i = i + 1;
    solutes(i).name = 'LiClO4';
    solutes(i).degree = standard_degree;
    solutes(i).data = [
0.023902671	0.99312409
0.035430565	0.989559478
0.046689343	0.985897538
0.057688321	0.98215537
0.068436389	0.978328705
0.078942036	0.974394068
0.089213372	0.97408342
0.099258149	0.970853658
0.109083782	0.96762275
0.128105688	0.961145366
0.146332302	0.954644613
0.16381248	0.94810584
0.180591154	0.941530436
0.196709723	0.934925178
0.227116464	0.921574397
0.248452564	0.911477687
0.268642308	0.901261665
0.293932907	0.887506052
0.311782017	0.877109847
0.32875094	0.866721748
0.35524636	0.849088256
0.379729562	0.831394046
0.402421389	0.813567169
0.423511507	0.795726799
0.443163721	0.777525106
    ];


    i = i + 1;
    solutes(i).name = 'KClO3';
    solutes(i).degree = standard_degree;
    solutes(i).data = [
0.023923632	0.993624446
0.035461267	0.990664994
0.046729328	0.987826105
0.057737156	0.985100404
0.068493661	0.982486999
0.079007354	0.979983622
    ];


    i = i + 1;
    solutes(i).name = 'NaBr';
    solutes(i).degree = standard_degree;
    solutes(i).data = [
0.170873564	0.929033463
0.235504785	0.879529457
0.292183065	0.837112211
0.339200445	0.7973299
0.373772943	0.754153032
0.450900961	0.613338651
    ];

    i = i + 1;
    solutes(i).name = 'NaI';
    solutes(i).degree = standard_degree;
    solutes(i).data = [
0.130804803	0.966918077
0.200489921	0.940935955
0.244406313	0.917314913
0.331142455	0.860753564
0.37235787	0.826057732
0.431944694	0.76438516
0.500802154	0.670117688
0.557282394	0.580052303
    ];

    i = i + 1;
    solutes(i).name = 'KBr';
    solutes(i).degree = standard_degree;
    solutes(i).data = [
0.129939226	0.952769499
0.160617517	0.945900319
0.208973406	0.926828896
0.264434913	0.900782505
0.311953433	0.875329942
0.341034878	0.832493212
    ];

    i = i + 1;
    solutes(i).name = 'RbCl';
    solutes(i).degree = standard_degree;
    solutes(i).data = [
0.152925394	0.952740321
0.264105566	0.903400861
0.300340175	0.88219092
0.35050847	0.854205178
0.420302061	0.793616075
0.456602386	0.742346272
    ];

    i = i + 1;
    solutes(i).name = 'CsBr';
    solutes(i).degree = standard_degree;
    solutes(i).data = [
0.250437576	0.948216525
0.323201955	0.931323802
0.370696381	0.922395563
0.425829469	0.903295082
0.478987351	0.884297594
0.556152339	0.847494672
    ];

    i = i + 1;
    solutes(i).name = 'CsI';
    solutes(i).degree = standard_degree-1; % Done since standard fit led to problematic fzero
    solutes(i).data = [
0.258954305	0.962440347
0.286563408	0.955352044
0.318521716	0.942111376
0.343512108	0.940867138
0.402702276	0.912445671
    ];

    i = i + 1;
    solutes(i).name = 'CaBr2';
    solutes(i).degree = standard_degree;
    solutes(i).data = [
0.167422467	0.931760793
0.198373545	0.912413125
0.25462802	0.873041879
0.310607301	0.811959213
0.376584869	0.714306481
0.402923991	0.668163428
0.441142719	0.592809925
0.47881227	0.511377747
    ];

    i = i + 1;
    solutes(i).name = 'CaI2';
    solutes(i).degree = standard_degree;
    solutes(i).data = [
0.250619423	0.92942618
0.300816803	0.905832291
0.355265067	0.870379167
0.400475749	0.844067367
0.461398483	0.75904549
    ];


    i = i + 1;
    solutes(i).name = 'SrCl2';
    solutes(i).degree = standard_degree;
    solutes(i).data = [
0.094979102	0.966928528
0.121326862	0.962135937
0.170764795	0.924383736
0.19242207	0.899056431
0.22171624	0.87712233
0.259712693	0.846839495
0.299190497	0.799208297
0.33676957	0.723464083
    ];

    i = i + 1;
    solutes(i).name = 'SrBr2';
    solutes(i).degree = standard_degree;
    solutes(i).data = [
0.165236438	0.936394995
0.200413604	0.931812662
0.249696136	0.915137164
0.30168221	0.879561781
0.330597835	0.846941562
0.372093913	0.810838369
0.396563094	0.771197726
0.45247967	0.685736556
    ];

    i = i + 1;
    solutes(i).name = 'SrI2';
    solutes(i).degree = standard_degree;
    solutes(i).data = [
0.248790797	0.936081285
0.301465012	0.910658366
0.343725923	0.888941675
0.400911621	0.844101124
0.447266181	0.795112072
0.500353298	0.732945831
0.545621697	0.650790875
0.586603144	0.558927683
    ];

    i = i + 1;
    solutes(i).name = 'BaCl2';
    solutes(i).degree = standard_degree;
    solutes(i).data = [
0.09497997	0.959965912
0.133203812	0.950607927
0.168761561	0.938725805
0.201782401	0.920052591
0.224218797	0.907767102
    ];

    i = i + 1;
    solutes(i).name = 'BaBr2';
    solutes(i).degree = standard_degree;
    solutes(i).data = [
0.22924975	0.938666449
0.273193539	0.921865807
0.30038976	0.907704307
0.336395135	0.887045071
0.359385141	0.872207612
0.400148511	0.846858718
0.426520476	0.825234615
0.502408769	0.745404586
    ];


end